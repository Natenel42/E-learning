{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/hp/Documents/ALX/E-learning/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\n// AuthGuard Service\nimport { Injectable } from '@angular/core';\nimport { firstValueFrom } from 'rxjs';\n//import { PreloadService } from './preload_service';\nlet AuthorizedLecturerOnlyGuard = class AuthorizedLecturerOnlyGuard {\n  constructor(router, appService, afs) {\n    this.router = router;\n    this.appService = appService;\n    this.afs = afs;\n  }\n  canActivate(route, state) {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const loggedInUser = yield _this.appService.loggedInUser();\n      if (loggedInUser === undefined || loggedInUser === null) {\n        _this.router.navigateByUrl(``);\n        return false;\n      } else {\n        const user = yield firstValueFrom(_this.afs.doc('Users/' + loggedInUser.uid).get());\n        const data = user.data();\n        _this.appService.currentUser = data;\n        if (data.role === 'lecturer') {\n          return true;\n        } else {\n          _this.router.navigateByUrl(`/${data.role}/home`);\n          return false;\n        }\n      }\n    })();\n  }\n};\nAuthorizedLecturerOnlyGuard = __decorate([Injectable()], AuthorizedLecturerOnlyGuard);\nexport { AuthorizedLecturerOnlyGuard };","map":{"version":3,"mappings":";;AAAA;AACA,SAASA,UAAU,QAAQ,eAAe;AAQ1C,SAASC,cAAc,QAAoB,MAAM;AAEjD;AAGO,IAAMC,2BAA2B,GAAjC,MAAMA,2BAA2B;EACtCC,YACUC,MAAc,EACfC,UAAsB,EACrBC,GAAqB;IAFrB,WAAM,GAANF,MAAM;IACP,eAAU,GAAVC,UAAU;IACT,QAAG,GAAHC,GAAG;EACV;EAEGC,WAAW,CACfC,KAA6B,EAC7BC,KAA0B;IAAA;IAAA;MAE1B,MAAMC,YAAY,SAAS,KAAI,CAACL,UAAU,CAACK,YAAY,EAAE;MACzD,IAAIA,YAAY,KAAKC,SAAS,IAAID,YAAY,KAAK,IAAI,EAAE;QACvD,KAAI,CAACN,MAAM,CAACQ,aAAa,CAAC,EAAE,CAAC;QAC7B,OAAO,KAAK;OACb,MAAM;QACL,MAAMC,IAAI,SAASZ,cAAc,CAC/B,KAAI,CAACK,GAAG,CAACQ,GAAG,CAAC,QAAQ,GAAGJ,YAAY,CAACK,GAAG,CAAC,CAACC,GAAG,EAAE,CAChD;QACD,MAAMC,IAAI,GAAQJ,IAAI,CAACI,IAAI,EAAE;QAC7B,KAAI,CAACZ,UAAU,CAACa,WAAW,GAAGD,IAAI;QAClC,IAAIA,IAAI,CAACE,IAAI,KAAK,UAAU,EAAC;UAC3B,OAAO,IAAI;SACZ,MACI;UACH,KAAI,CAACf,MAAM,CAACQ,aAAa,CAAC,IAAIK,IAAI,CAACE,IAAI,OAAO,CAAC;UAC/C,OAAO,KAAK;;;IAEf;EACH;CACD;AA9BYjB,2BAA2B,eADvCF,UAAU,EAAE,GACAE,2BAA2B,CA8BvC;SA9BYA,2BAA2B","names":["Injectable","firstValueFrom","AuthorizedLecturerOnlyGuard","constructor","router","appService","afs","canActivate","route","state","loggedInUser","undefined","navigateByUrl","user","doc","uid","get","data","currentUser","role"],"sourceRoot":"","sources":["C:\\Users\\hp\\Documents\\ALX\\E-learning\\src\\app\\route-guards\\AuthorizedLecturerOnly.ts"],"sourcesContent":["// AuthGuard Service\r\nimport { Injectable } from '@angular/core';\r\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\r\nimport {\r\n  CanActivate,\r\n  ActivatedRouteSnapshot,\r\n  RouterStateSnapshot,\r\n  Router,\r\n} from '@angular/router';\r\nimport { firstValueFrom, Observable } from 'rxjs';\r\nimport { AppService } from '../services/app.service';\r\n//import { PreloadService } from './preload_service';\r\n\r\n@Injectable()\r\nexport class AuthorizedLecturerOnlyGuard implements CanActivate {\r\n  constructor(\r\n    private router: Router,\r\n    public appService: AppService,\r\n    private afs: AngularFirestore\r\n  ) {}\r\n\r\n  async canActivate(\r\n    route: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): Promise<boolean> {\r\n    const loggedInUser = await this.appService.loggedInUser();\r\n    if (loggedInUser === undefined || loggedInUser === null) {\r\n      this.router.navigateByUrl(``);\r\n      return false;\r\n    } else {\r\n      const user = await firstValueFrom(\r\n        this.afs.doc('Users/' + loggedInUser.uid).get()\r\n      );\r\n      const data: any = user.data();\r\n      this.appService.currentUser = data;\r\n      if (data.role === 'lecturer'){\r\n        return true;\r\n      }\r\n      else {\r\n        this.router.navigateByUrl(`/${data.role}/home`);\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}